<!DOCTYPE html>
<html lang="nn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ved, varmepumpe eller straum?</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- Chart library -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header class="site-header">
    <div class="container">
      <h1 class="site-title">Ved, varmepumpe eller straum – kva lønner seg no?</h1>
      <p class="site-subtitle">Basert på straumpris, nettleige, vedpris og temperatur.</p>

      <div class="header-actions">
        <button type="button" class="btn" onclick="getEnergyPrice()">Oppdater</button>
        <span class="meta">Oppdatert: <span id="lastUpdated">–</span></span>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- 1) Primary decision / recommendation -->
    <section class="card card-hero" aria-labelledby="decisionTitle">
      <div class="hero-content">
        <h2 id="decisionTitle" class="hero-title">Anbefaling</h2>
        <!-- NOTE: This text is currently static. Later we can set it dynamically from JS. -->
        <p class="hero-recommendation" id="recommendationText">—</p>
        <p class="hero-support">
          Straum: <strong><span class="inklNettleige">–</span> kr/kWh</strong>
          <span class="dot">·</span>
          Ved: <strong><span class="woodPrice">–</span> kr/kWh</strong>
          <span class="dot">·</span>
          Varmepumpe: <strong><span class="heatpumpPrice">–</span> kr/kWh</strong>
        </p>
      </div>

      <!-- Keep existing traffic light elements (used by current JS) -->
      <aside class="hero-traffic" aria-label="Trafikklys">
        <div class="traffic-light" role="img" aria-label="Trafikklys som viser anbefaling">
          <div id="red" class="light"></div>
          <div id="yellow" class="light"></div>
          <div id="green" class="light"></div>
        </div>
        <p id="red-text" class="traffic-text" hidden>Raudt lys: bruk elektrisitet!</p>
        <p id="yellow-text" class="traffic-text" hidden>Gult lys: Det er lite forskjell. Varmepumpe vil nok lønne seg.</p>
        <p id="green-text" class="traffic-text" hidden>Grønt lys: fyr i peisen!</p>
      </aside>
    </section>

    <!-- 2) Settings (collapsible) -->
    <section class="card" aria-labelledby="settingsTitle">
      <details open>
        <summary class="details-summary" id="settingsTitle">Innstillingar</summary>

        <div class="settings-grid">
          <fieldset class="settings-group">
            <legend>Straum</legend>

            <label for="price-area">Prisområde</label>
            <select id="price-area" onchange="getEnergyPrice()">
              <option value="NO1">NO1</option>
              <option value="NO2">NO2</option>
              <option value="NO3" selected>NO3</option>
              <option value="NO4">NO4</option>
              <option value="NO5">NO5</option>
            </select>

            <label for="company">Nettselskap</label>
            <select id="company" onchange="getEnergyPrice()">
              <option value="Eviny" selected>Eviny</option>
              <option value="Glitre">Glitre</option>
            </select>

            <p class="hint">Straum inkl. nettleige (kr/kWh): <strong><span class="inklNettleige">–</span></strong></p>
          </fieldset>

          <fieldset class="settings-group">
            <legend>Ved</legend>

            <label for="volume">Volum</label>
            <select id="volume" onchange="getEnergyPrice()">
              <option value="11">30 L</option>
              <option value="15">40 L</option>
              <option value="22">60 L</option>
              <option value="28">80 L</option>
              <option value="300">1000 L</option>
              <option value="450" selected>1500 L</option>
            </select>

            <label for="purchasePrice">Kjøpspris (kr)</label>
            <input id="purchasePrice" inputmode="numeric" value="2000" onchange="getEnergyPrice()" />

            <label for="efficiency">Omnens effektivitet (%)</label>
            <input id="efficiency" inputmode="numeric" value="77" onchange="getEnergyPrice()" />

            <p class="hint">Vedpris (kr/kWh): <strong><span class="woodPrice">–</span></strong></p>
          </fieldset>

          <fieldset class="settings-group">
            <legend>Varmepumpe</legend>

            <label for="outsideTemp">Utetemperatur (°C)</label>
            <div class="inline">
              <input id="outsideTemp" type="number" value="7" onchange="getEnergyPrice()" />
              <button type="button" class="btn btn-secondary" onclick="getTemperature()">Hent</button>
            </div>

            <p class="hint">Estimert COP: <strong><span class="heatpumpCOP">–</span></strong></p>
            <p class="hint">Varmepumpepris (kr/kWh): <strong><span class="heatpumpPrice">–</span></strong></p>
          </fieldset>
        </div>
      </details>
    </section>

    <!-- 3) Quick comparison cards -->
    <section class="cards-3" aria-label="Prisoversikt">
      <article class="card metric">
        <h3>Straum</h3>
        <p class="metric-value"><span class="inklNettleige">–</span> <span class="unit">kr/kWh</span></p>
        <p class="metric-note">Inkl. nettleige & støtte</p>
      </article>

      <article class="card metric">
        <h3>Ved</h3>
        <p class="metric-value"><span id="woodPrice">–</span> <span class="unit">kr/kWh</span></p>
        <p class="metric-note">Basert på vedkostnad</p>
      </article>

      <article class="card metric">
        <h3>Varmepumpe</h3>
        <p class="metric-value"><span class="heatpumpPrice">–</span> <span class="unit">kr/kWh</span></p>
        <p class="metric-note">COP-justert pris</p>
      </article>
    </section>

    <!-- 4) Chart -->
    <section class="card" aria-labelledby="chartTitle">
      <div class="card-header">
        <h2 id="chartTitle">Pris gjennom døgnet</h2>
        <div class="chart-toggles" aria-label="Vis linjer">
          <!-- These are UI-only for now; wiring can be done later. 
          <label><input type="checkbox" checked /> Straum</label>
          <label><input type="checkbox" checked /> Ved</label>
          <label><input type="checkbox" checked /> Varmepumpe</label> -->
        </div>
      </div>

      <div class="chart-wrap">
        <canvas id="energyChart"></canvas>
      </div>

      <p class="small">X-akse: timar (0–23). Y-akse: kr/kWh.</p>
    </section>

    <!-- 5) Details / methodology -->
    <section class="card" aria-labelledby="calcTitle">
      <details>
        <summary class="details-summary" id="calcTitle">Korleis reknar vi?</summary>
        <div class="prose">
          <h3>Utrekning straumpris denne timen</h3>
          <ul>
            <li>Full pris i sone: <span id="totalPrice">–</span></li>
            <li>Pris utan MVA: <span id="exVatPrice">–</span></li>
            <li>Straumstøtte: <span id="subsidizedPrice">–</span></li>
            <li>Pris med støtte: <span id="adjustedPrice">–</span></li>
            <li>Pris inkl. nettleige: <span class="inklNettleige">–</span></li>
          </ul>

          <h3>Varmepumpekalkulasjon</h3>
          <p>
            COP (Coefficient of Performance) viser kor mange kWh varme pumpa gjev per kWh straum.
            COP varierer med utetemperaturen.
          </p>
          <p>Estimert COP ved oppgitt temperatur: <strong><span class="heatpumpCOP">–</span></strong></p>
          <p>Varmepumpepris denne timen: <strong><span class="heatpumpPrice">–</span></strong></p>
        </div>
      </details>
    </section>
  </main>

  <script src="script.js" defer></script>
</body>
</html>
